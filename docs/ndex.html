<style>
    * { 
        background-color:#202225; 
        color:#959ca6; 
        border:1px solid #40444b; 
        border-radius:5px; 
    }
</style>

<script src="https://unpkg.com/json5@2/dist/index.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<select id="SelectVersion">
    <option disabled selected>Select a version</option>
</select>

<hr>

<select id="TCZList" style="width:15vw;height:100%" size="2"></select>
<script>
    $(document).ready(function(){

        $('#SelectVersion').change(function(){
            var selectedOption = $('#SelectVersion option:selected');
            var selectedOptgroup = selectedOption.closest('optgroup').attr('label');
            var selectedValue = selectedOption.val();

            $.get(`data/${selectedOptgroup}/${selectedValue}/tczlist`, function(data){
                $('#TCZList').empty(); 
                data.split('\n').forEach(line => {
                    $('#TCZList').append($('<option>', { text: line }));
                });
            });
        });
        //The json is invalid because it has Trailing commas, but .get still forces the file to be read as JSON. I need to use AJAX to avoid jquery parse so I can use JSON5.
        $.ajax({
            url: 'site-data/versions.json',
            dataType: 'text',
            success: function(data){
                var parsedData = JSON5.parse(data);
                $.each(parsedData, function(version, values){
                    $('#SelectVersion').append(
                        $('<optgroup>', { label: version }).append(
                            values.map(function(value){
                                return $('<option>', { value: value, text: value });
                            })
                        )
                    );
                });
            }
        });
    });
</script>
