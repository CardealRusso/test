<link href="https://fonts.cdnfonts.com/css/liberation-mono" rel="stylesheet">
<style>
    * { 
        background-color:#202225; 
        color:#959ca6; 
        border:0px solid #40444b; 
        border-radius:5px;
        font-family: 'Liberation Mono', sans-serif;
    }

    #TCZList {
        width:15vw;
        height:100%;
        border:1px solid #40444b;
    }

    #InfoList {
        border:1px solid #40444b;
        white-space: break-spaces;
    }

    #SelectVersion {
        border:1px solid #40444b;
    }

    hr {
        border:1px solid #40444b;
    }

    table {
        max-width:100%;
        white-space:nowrap;
        height:100%;
    }
</style>

<script src="https://unpkg.com/json5@2/dist/index.min.js"></script>
<script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>

<select id="SelectVersion">
    <option disabled selected>Select a version</option>
</select>
<hr>

<table>
    <tr>
        <td>
            <select id="TCZList" size="2"></select>
        </td>
        <td valign="top">
            <div id=InfoList><div>
        </td>
    </tr>
</table>
<script>
   var selectedVersion, selectedArch;
   
   $(document).ready(function(){
       $('#SelectVersion').change(function(){
           var selectedOption = $('#SelectVersion option:selected');
           selectedVersion = selectedOption.closest('optgroup').attr('label');
           selectedArch = selectedOption.val();
   
           $.get(`https://raw.githubusercontent.com/CardealRusso/tinycore-online-repo/main/data/${selectedVersion}/${selectedArch}/tczlist`, function(data){
               $('#TCZList').empty(); 
               data.split('\n').forEach(line => {
                   $('#TCZList').append($('<option>', { text: line }));
               });
           });
       });
   
       $('#TCZList').change(function(){
           var selectedItem = $('#TCZList option:selected').text();
           var infoUrl = `https://raw.githubusercontent.com/CardealRusso/tinycore-online-repo/main/tinycorelinux/${selectedVersion}/${selectedArch}/tcz/${selectedItem}.info`;
   
           $.get(infoUrl, function(infoData){
               var formattedInfo = infoData.replace(/\n/g, '<br>');
               $('#InfoList').html(formattedInfo);
           });
       });
   
       $.get('https://raw.githubusercontent.com/CardealRusso/tinycore-online-repo/main/site-data/versions', function(data){
           var parsedData = JSON5.parse(data);
           
           Object.keys(parsedData).sort((a, b) => parseInt(b) - parseInt(a)).forEach(version => {
               $('#SelectVersion').append(
                   $('<optgroup>', { label: version }).append(
                       parsedData[version].map(value => $('<option>', { value: value, text: value }))
                   )
               );
           });
       });
   });
</script>
